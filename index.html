<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dark Cafe — شاشة الغرف</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Tajawal',sans-serif;background:#0f1115;color:#f0f3f7;margin:0;padding:24px}
    h1{text-align:center;color:#8ab4f8;margin:0 0 20px}
    #rooms{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
    .room{border:1px solid #243042;background:#131824;border-radius:12px;padding:14px;text-align:center}
    .room h3{margin:0 0 10px}
    .tag{display:inline-block;padding:4px 10px;border-radius:999px;font-size:.85rem}
    .tag.available{background:#0e4d33}
    .tag.busy{background:#5a1a1a}
    .muted{color:#98a2b3;font-size:.9rem}
  </style>
</head>
<body>
  <h1>حالة الغرف</h1>
  <div id="rooms">جارٍ التحميل…</div>

  <script src="./config.js"></script>
  <script>
    const list=document.getElementById('rooms');

    async function load(){
      list.textContent='جارٍ التحديث…';
      try{
        const res=await fetch(https://script.google.com/macros/s/AKfycbyyT_BavvpFvkJU_4MkSmVJ1VjL-WFq-Zi4lV5aenKCYH4kW-aeyBdjMYr9jg0nRLUh/exec);
        const rooms=await res.json();
        list.innerHTML='';
        if(Array.isArray(rooms)&&rooms.length){
          rooms.forEach(r=>{
            const busy=(r.Status==='Busy'||r.Status==='مشغولة');
            const el=document.createElement('div');
            el.className='room';
            el.innerHTML=`
              <h3>${r.RoomName||'غرفة'}</h3>
              <div class="tag ${busy?'busy':'available'}">${busy?'مشغولة':'متاحة'}</div>
              <div class="muted" style="margin-top:8px">الكود: ${r.RoomID||'-'}</div>`;
            list.appendChild(el);
          });
        }else{
          list.textContent='لا توجد غرف بعد.';
        }
      }catch(e){
        list.textContent='تعذر تحميل البيانات.';
        console.error(e);
      }
    }
    load();
    setInterval(load, 60000);
  </script>
</body>
</html>
